<!DOCTYPE html>
<html>

<head>
  <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.2.6 -->

  <!-- Title -->

  <title>

    使用CNPM搭建私有NPM仓库 | Rum&#39;s Blog
  </title>

  <!-- Favicons -->
  <link rel="icon shortcut" type="image/ico" href="favicon.png">
  <link rel="icon" sizes="192x192" href="/img/favicon.png">
  <link rel="apple-touch-icon" href="favicon.png">

  <!-- Meta & Info -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#0097A7">
  <meta name="author" content="xiaoxiao">
  <meta name="description" content="明天会更好！">
  <meta name="keywords" content="null">

  <!--iOS -->
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-title" content="Title">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="480">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Rum&#39;s Blog">

  <!-- The Open Graph protocol -->
  <meta property="og:url" content="http://www.pangjian.me">
  <meta property="og:type" content="blog">
  <meta property="og:title" content="使用CNPM搭建私有NPM仓库 | Rum&#39;s Blog">
  <meta property="og:description" content="明天会更好！">

  <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

  <!-- Import CSS -->
  <link rel="stylesheet" href="/css/material.min.css" type="text/css">
  <link rel="stylesheet" href="/css/style.min.css" type="text/css">
  <!-- Config CSS -->


  <!-- Other Styles -->
  <style>
    body,
    html {
      font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    }

    a {
      color: #00838F;
    }

    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge {
      background-color: #0097A7 !important;
    }

    /* Sidebar User Drop Down Menu Text Color */

    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
      color: #0097A7 !important;
    }

    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover>a,
    .sidebar-colored .sidebar-nav li:hover>a i,
    .sidebar-colored .sidebar-nav li>a:hover,
    .sidebar-colored .sidebar-nav li>a:hover i,
    .sidebar-colored .sidebar-nav li>a:focus i,
    .sidebar-colored .sidebar-nav>.open>a,
    .sidebar-colored .sidebar-nav>.open>a:hover,
    .sidebar-colored .sidebar-nav>.open>a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
      color: #0097A7 !important;
    }

    .toTop {
      background: #757575 !important;
    }

    .material-layout .material-post>.material-nav,
    .material-layout .material-index>.material-nav,
    .material-nav a {
      color: #757575;
    }

    #scheme-Paradox .MD-burger-layer {
      background-color: #757575;
    }

    #scheme-Paradox #post-toc-trigger-btn {
      color: #757575;
    }

    .post-toc a:hover {
      color: #00838F;
      text-decoration: underline;
    }

    @media screen and (max-width:480px) {
      .post_thumbnail-custom {
        min-height: 200px;
      }
    }

    @media screen and (min-width: 481px) {
      .post_thumbnail-custom {
        min-height: 350px;
      }
    }
  </style>


  <!-- Theme Background Related-->

  <style>
    body {
      background-image: url(/img/bg.png);
    }
  </style>




  <!-- Fade Effect -->

  <style>
    .fade {
      transition: all 800ms linear;
      -webkit-transform: translate3d(0, 0, 0);
      -moz-transform: translate3d(0, 0, 0);
      -ms-transform: translate3d(0, 0, 0);
      -o-transform: translate3d(0, 0, 0);
      transform: translate3d(0, 0, 0);
      opacity: 1;
    }

    .fade.out {
      opacity: 0;
    }
  </style>
  <script src="/js/jquery.min.js" type="text/javascript"></script>

  <link rel="stylesheet" href="/css/highlight/atom-one-dark.css" type="text/css">

  <!-- UC Browser Compatible-->
  <script>
    var agent = navigator.userAgent.toLowerCase();
    if (agent.indexOf('ucbrowser') > 0) {
      document.write('<link rel="stylesheet" href="/css/uc.css" type="text/css">');
      alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
    }
  </script>

  <!-- Custom Head -->

</head>


<body id="scheme-Paradox">
  <div class="material-layout  mdl-js-layout has-drawer is-upgraded">


    <!-- Main Container -->
    <main class="material-layout__content" id="main">
      <div id="pjax">

        <!-- Top Anchor -->
        <div id="top"></div>


        <!-- Hamburger Button -->
        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>


        <!-- Post TOC -->

        <!-- Back Button -->
        <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

        <!-- Left aligned menu below button -->
        <button id="post-toc-trigger-btn" class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

        <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
          <ol class="post-toc">
            <li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#环境配置"><span class="post-toc-number">1.</span> <span class="post-toc-text">环境配置</span></a></li>
            <li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#安装MySQL"><span class="post-toc-number">2.</span> <span class="post-toc-text">安装MySQL</span></a></li>
            <li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#安装cnpm"><span class="post-toc-number">3.</span> <span class="post-toc-text">安装cnpm</span></a>
              <ol class="post-toc-child">
                <li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#从github下载cnpmjs-org"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">从github下载cnpmjs.org</span></a></li>
                <li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#初始化数据库"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">初始化数据库</span></a></li>
                <li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#编辑配置文件"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">编辑配置文件</span></a></li>
              </ol>
            </li>
            <li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#如何使用私有仓库"><span class="post-toc-number">4.</span> <span class="post-toc-text">如何使用私有仓库</span></a>
              <ol class="post-toc-child">
                <li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#下载指定私有库"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">下载指定私有库</span></a></li>
                <li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#修改默认库为私有库"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">修改默认库为私有库</span></a></li>
              </ol>
            </li>
          </ol>

          <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
        </ul>


        <!-- Layouts -->

        <!-- Post Module -->
        <div class="material-post_container">

          <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

              <!-- Post Header(Thumbnail & Title) -->
              <!-- Paradox Post Header -->

              <!-- Custom Thumbnail -->
              <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(/resources/cnpm-local-npm-server/cnpmtitle.png)">

                <p class="article-headline-p">
                  使用CNPM搭建私有NPM仓库
                </p>
              </div>


              <!-- Paradox Post Info -->
              <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

                <!-- Author Avatar -->
                <div id="author-avatar">
                  <img src="/img/myavatar.jpg" width="44px" height="44px" alt="Author Avatar" />
                </div>
                <!-- Author Name & Date -->
                <div>
                  <strong>xiaoxiao</strong>
                  <span>6月 01, 2016</span>
                </div>

                <div class="section-spacer"></div>
                <div>
                  <span class="post-count">总字数：911</span>
                  <span class="post-count">预计阅读：4 min</span>
                </div>

                <!-- Favorite -->
                <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

                <!-- Qrcode -->

                <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
            <i class="material-icons" role="presentation">devices other</i>
            <span class="visuallyhidden">devices other</span>
        </button>
                <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
                  <li class="mdl-menu__item">在其它设备中阅读本文章</li>
                  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAACzklEQVR42u3aQUIbMRAEQP7/afKAJKZ7xgYj1Z442GuVLo169PF55fOBjY2NjY2NjY2N/Zbsj/j5+/P/ePV/Ppm/4fHaZmvGxsbGvoGd/Hy7oMfb8RiZfLJeMzY2NvYF7MeYJGaSN8+o+zVjY2NjYz8+BiSM/QEGGxsbG/sV7MfHlXw72mILGxsbG3vzr38eKnmM7WupF3Zp2NjY2G/P3oTHT/39A/NtbGxs7Ldkt08y9G0v5Xx+y4ONjY19Kvt1lX2yTe1GFHE1O4FhY2Nj/1p2cr2mreP3hVHOS4ITGxsb+2x2W/cnW7CJxjZio/DDxsbGPpSdjGbbUe5m8JAfgepDDjY2Nvah7Dxm2kPF/lfyKE3iEBsbG/tU9qaaz4MqL4zqizj5UBkbGxv7YnY+xG3DKR9UtNuNjY2NfQ87v/jyrEHCZls3YYaNjY19Kjsv9NsrPm0VlW99PkjAxsbGvofdFv2bTZmFZb5l2NjY2LexZ2VNO3x93fB4OB7AxsbGvoCdjxDy6n8Wh7O3YWNjY9/D3hdMyfbtRwuzugobGxv7Bna+3NmVnTychqV/EJ/Y2NjYZ7NbQL4deeDlg97ZYAAbGxv7BnYbV+1GJLV+O8rFxsbGxp7VOu1geFbxz4bBX3wXGxsb+2h2W8HnP5+H1rD0f1aXho2Njf1r2bOyZnZZs72mmR9anjDfxsbGxj6CnV983G9Hu/T95mJjY2Ofyt78u98eKtoj0CwmV6USNjY29i9kt88movYHnlnoYmNjY5/N3h8YkhhLSvxZOCUBjI2NjX0DOw+tdult3T+74rO6qYSNjY19EHsWHs+90NPG26pLw8bGxr6S/T2DgeS7+QEJGxsbGztZenJUaCuktqKqxwPY2NjYx7HzUimPt1klNCuwvqilsLGxsY9mt4PefOjb1lX5safdRGxsbOxT2fc82NjY2NjY2NjY2G/z/AGyrgttcBMP2QAAAABJRU5ErkJggg==">
                </ul>


                <!-- Tags (bookmark) -->

                <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
                <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
                  <li class="mdl-menu__item">
                    <a class="post_tag-link" href="/tags/Nodejs/">Nodejs</a></li>
                  <li class="mdl-menu__item"><a class="post_tag-link" href="/tags/cnpm/">cnpm</a>
                </ul>


                <!-- Share -->
                <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
                <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">

                  <!-- Leancloud Views -->
                  <a class="post_share-link" href="#">
                    <li class="mdl-menu__item">
                      <span id="/2016/06/01/cnmp-local-npm-server/" class="leancloud-views_num" data-flag-title="使用CNPM搭建私有NPM仓库">
     &nbsp;浏览量
</span>
                    </li>
                  </a>




                  <!-- Share Weibo -->

                  <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=使用CNPM搭建私有NPM仓库&url=http://www.pangjian.me//2016/06/01/cnmp-local-npm-server/index.html&pic=&searchPic=false&style=simple" target="_blank">
                    <li class="mdl-menu__item">
                      分享到微博
                    </li>
                  </a>


                  <!-- Share Twitter -->

                  <a class="post_share-link" href="https://twitter.com/intent/tweet?text=使用CNPM搭建私有NPM仓库&url=http://www.pangjian.me//2016/06/01/cnmp-local-npm-server/index.html&via=xiaoxiao" target="_blank">
                    <li class="mdl-menu__item">
                      分享到 Twitter
                    </li>
                  </a>


                  <!-- Share Facebook -->

                  <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://www.pangjian.me//2016/06/01/cnmp-local-npm-server/index.html" target="_blank">
                    <li class="mdl-menu__item">
                      分享到 Facebook
                    </li>
                  </a>


                  <!-- Share Google+ -->

                  <a class="post_share-link" href="https://plus.google.com/share?url=http://www.pangjian.me//2016/06/01/cnmp-local-npm-server/index.html" target="_blank">
                    <li class="mdl-menu__item">
                      分享到 Google+
                    </li>
                  </a>


                  <!-- Share LinkedIn -->

                  <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=http://www.pangjian.me//2016/06/01/cnmp-local-npm-server/index.html&title=使用CNPM搭建私有NPM仓库" target="_blank">
                    <li class="mdl-menu__item">
                      分享到 LinkedIn
                    </li>
                  </a>


                  <!-- Share QQ -->

                  <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Rum&#39;s Blog&title=使用CNPM搭建私有NPM仓库&summary=明天会更好！&pics=http://www.pangjian.mefavicon.png&url=http://www.pangjian.me/2016/06/01/cnmp-local-npm-server/index.html" target="_blank">
                    <li class="mdl-menu__item">
                      分享到 QQ
                    </li>
                  </a>


                  <!-- Share Telegram -->

                </ul>
              </div>


              <!-- Post Content -->
              <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">

                <p>我们在使用Nodejs的时候，使用npm仓库来发布和管理模块，我们可以从npm上下载别人发布的模块使用，也可以自己发布模块，有点类似于Maven，这是非常流行的开源社区模式。但是在企业内部，我们不希望我们的生产代码可以随意引用任何未经企业审核的代码；我们也不希望企业内部自己的模块发布给任意人员使用；还有一个重要的原因是很多企业内部无法连接互联网<code>cnpm</code>就是来解决这些问题的。官方的解释是<code>cnpm</code>=<strong>Company npm</strong></p>
                <h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1>
                <ul>
                  <li>OS：Red Hat Enterprise Linux Server release 6.4 (Santiago)</li>
                  <li>node：v4.4.5</li>
                  <li>npm：2.15.5</li>
                  <li>cnpm：2.10.0（截止到本文发布）</li>
                </ul>
                <a id="more"></a>
                <h1 id="安装MySQL"><a href="#安装MySQL" class="headerlink" title="安装MySQL"></a>安装MySQL</h1>
                <p><code>cnpmjs.org</code>依赖一个数据库，官方支持<code>sqllite3</code>、<code>MySQL</code>、<code>MariaDB</code>、<code>PostgreSQL</code>中的任何一个，我选择了<code>MySQL</code>。<br>我们的操作系统是Red Hat 6.4，在这个动作之前应当将Red Hat自带的yum替换成CentOS的，此步骤不再赘述。<br>编辑源列表：<br>
                  <figure class="highlight">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">$ vim /etc/yum.repos.d/rhel-debuginfo.repo</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>添加如下内容：<br>
                  <figure class="highlight coffeescript">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">[mysql56]</span><br><span class="line">name=MySQL <span class="number">5.6</span></span><br><span class="line">baseurl=<span class="attribute">http</span>:<span class="regexp">//</span>repo.mysql.com<span class="regexp">/yum/mysql-5.6-community/el/6/</span>$basearch/</span><br><span class="line">enabled=<span class="number">1</span></span><br><span class="line">gpgcheck=<span class="number">0</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>然后执行：<br>
                  <figure class="highlight">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">$ yum update&#10;$ sudo yum install mysql-community-server&#10;$ sudo service mysqld start</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>安装完成后，创建一个名叫cnpmjs的DATABASE。<br>
                  <figure class="highlight">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">$ mysql -u root -p&#10;&#10;mysql&#62; create datebase cnpmjs</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <h1 id="安装cnpm"><a href="#安装cnpm" class="headerlink" title="安装cnpm"></a>安装cnpm</h1>
                <h2 id="从github下载cnpmjs-org"><a href="#从github下载cnpmjs-org" class="headerlink" title="从github下载cnpmjs.org"></a>从<code>github</code>下载<code>cnpmjs.org</code></h2>
                <figure class="highlight">
                  <table>
                    <tr>
                      <td class="code">
                        <pre><span class="line">$ git clone git://github.com/cnpm/cnpmjs.org.git&#10;$ cd cnpmjs.org&#10;#&#23433;&#35013;&#20381;&#36182;&#10;$ npm install</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>
                <p>在国内npm缓慢甚至有些模块被墙，可以使用cnpm淘宝的镜像源安装。</p>
                <h2 id="初始化数据库"><a href="#初始化数据库" class="headerlink" title="初始化数据库"></a>初始化数据库</h2>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="code">
                        <pre><span class="line">mysql&#62; use cnpmjs;&#10;mysql&#62; source docs/db.sql</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>
                <h2 id="编辑配置文件"><a href="#编辑配置文件" class="headerlink" title="编辑配置文件"></a>编辑配置文件</h2>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="code">
                        <pre><span class="line">$ vim config/index.js</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>
                <p>修改数据库配置，找到如下配置，将MySQL的配置填入<br>
                  <figure class="highlight plain">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">database: &#123;&#10;    db: &#39;cnpmjs&#39;,&#10;    username: &#39;root&#39;,&#10;    password: &#39;123456&#39;,&#10;&#10;    // the sql dialect of the database&#10;    // - currently supported: &#39;mysql&#39;, &#39;sqlite&#39;, &#39;postgres&#39;, &#39;mariadb&#39;&#10;    dialect: &#39;mysql&#39;,&#10;&#10;    // custom host; default: 127.0.0.1&#10;    host: &#39;127.0.0.1&#39;,&#10;&#10;    // custom port; default: 3306&#10;    port: 3306,&#10;&#10;    // use pooling in order to reduce db connection overload and to increase speed&#10;    // currently only for mysql and postgresql (since v1.5.0)&#10;    pool: &#123;&#10;      maxConnections: 10,&#10;      minConnections: 0,&#10;      maxIdleTime: 30000&#10;    &#125;,&#10;&#10;    // the storage engine for &#39;sqlite&#39;&#10;    // default store into ~/.cnpmjs.org/data.sqlite&#10;    storage: path.join(dataDir, &#39;data.sqlite&#39;),&#10;&#10;    logging: !!process.env.SQL_DEBUG,&#10;  &#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>开启对外服务，注掉以下内容<br>
                  <figure class="highlight plain">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">//bindingHost: &#39;127.0.0.1&#39;, // only binding on 127.0.0.1 for local access</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>同步模式，由于硬盘资源有限，我选择了exist只同步已经存在的模块<br>
                  <figure class="highlight plain">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">// sync mode select&#10;// none: do not sync any module, proxy all public modules from sourceNpmRegistry&#10;// exist: only sync exist modules&#10;// all: sync all modules&#10;syncModel: &#39;exist&#39;, // &#39;none&#39;, &#39;all&#39;, &#39;exist&#39;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>其他自定义配置，比如管理员、说明文档等等都可以自行修改。</p>
                <p>启动<br>
                  <figure class="highlight">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">$ npm run start</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>停止<br>
                  <figure class="highlight">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">$ npm run stop</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>cnmp启动以后会占用7001和7002两个端口，在iptables中开放这两个端口。<br>打开浏览器输入<code>http://ip:7002</code>，看到如下界面，安装成功。我替换了个Logo<br><img src="/resources/cnpm-local-npm-server/cnpm.png" alt="cnpm"></p>
                <h1 id="如何使用私有仓库"><a href="#如何使用私有仓库" class="headerlink" title="如何使用私有仓库"></a>如何使用私有仓库</h1>
                <p>当我们使用私有的仓库时，模块就会从私有库中下载，如果私有库中没有，cnpm就会去npm仓库中下载，并保存在私有仓库一份。</p>
                <h2 id="下载指定私有库"><a href="#下载指定私有库" class="headerlink" title="下载指定私有库"></a>下载指定私有库</h2>
                <figure class="highlight">
                  <table>
                    <tr>
                      <td class="code">
                        <pre><span class="line">$ npm install debug --registry=http://ip:7001</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>
                <p>这样，本次下载npm就会从你指定的私有仓库中下载</p>
                <h2 id="修改默认库为私有库"><a href="#修改默认库为私有库" class="headerlink" title="修改默认库为私有库"></a>修改默认库为私有库</h2>
                <p>如果不希望每一次都设置私有库，可以设置默认配置为私有仓库<br>
                  <figure class="highlight">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line"># &#21015;&#20986;npm&#37197;&#32622;&#10;$ npm config list&#10;&#10;$ npm config set registry http://ip:7001</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>这样，一个私有的npm仓库就算搭建完成了。<br>EOF<br>
                  <span class='source'><blockquote class='source'><p>转载请注明出处：http://www.pangjian.me/2016/06/01/cnmp-local-npm-server/</p><p>访问原文「<a href='http://www.pangjian.me/2016/06/01/cnmp-local-npm-server/'>使用CNPM搭建私有NPM仓库</a>」获取最佳阅读体验并参与讨论</p></blockquote></span>
                  <script type="text/javascript">
                    (function() {
                      Element.prototype.remove = function() {
                        this.parentElement.removeChild(this);
                      }
                      NodeList.prototype.remove = HTMLCollection.prototype.remove = function() {
                        for (var i = this.length - 1; i >= 0; i--) {
                          if (this[i] && this[i].parentElement) {
                            this[i].parentElement.removeChild(this[i]);
                          }
                        }
                      }
                      var domain = document.domain;
                      var white_list = ['pangjian.info', 'www.pangjian.info', 'pangjian.me', 'www.pangjian.me', 'localhost', '127.0.0.1'];
                      if (white_list.indexOf(domain) >= 0) {
                        var elements = document.getElementsByClassName('source');
                        elements.remove();
                      }
                    })()
                  </script>

                </p>



              </div>



              <!-- Post Comments -->

              <!-- 使用多说评论 -->
              <link rel="stylesheet" href="/css/duoshuo.min.css" type="text/css">
              <style>
                #ds-thread #ds-reset .ds-post-button {
                  background-color: #0097A7 !important;
                }

                #ds-wrapper #ds-reset .ds-icons-32 {
                  background-color: #0097A7 !important;
                }

                #ds-reset .ds-highlight {
                  color: #0097A7 !important;
                }
              </style>
              <div id="comments">
                <!-- 多说评论框 start -->
                <div class="ds-thread" data-thread-key="2016/06/01/cnmp-local-npm-server/" data-url="http://www.pangjian.me/2016/06/01/cnmp-local-npm-server/" data-title="使用CNPM搭建私有NPM仓库">
                </div>
                <!-- 多说评论框 end -->
              </div>

            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
              <!-- Prev Nav -->

              <a href="/2016/12/02/deploy-nodejs-pm2-1/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>


              <!-- Section Spacer -->
              <div class="section-spacer"></div>

              <!-- Next Nav -->

              <a href="/2016/05/25/travis-ci-hexo/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>

            </nav>
          </div>
        </div>


        <!-- Overlay For Active Sidebar -->
        <div class="sidebar-overlay"></div>

        <!-- Material sidebar -->
        <aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
          <div id="sidebar-main">
            <!-- Sidebar Header -->
            <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
              <!-- Top bar -->
              <div class="top-bar"></div>

              <!-- Sidebar toggle button -->
              <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

              <!-- Sidebar Avatar -->
              <div class="sidebar-image">
                <img src="/img/myavatar.jpg" alt="xiaoxiao's avatar">
              </div>

              <!-- Sidebar Email -->
              <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        pangjian1010@gmail.com
        <b class="caret"></b>
    </a>
            </div>

            <!-- Sidebar Navigation  -->
            <ul class="nav sidebar-nav">
              <!-- User dropdown  -->
              <li class="dropdown">
                <ul id="settings-dropdown" class="dropdown-menu">

                  <li>
                    <a href="mailto:pangjian1010@gamil.com" target="_blank" title="Email Me">
                        <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                  </li>

                </ul>
              </li>

              <!-- Homepage -->
              <li id="sidebar-first-li">
                <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
            主页
        </a>
              </li>

              <!-- I'm Feeling Lucky -->
              <!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
    -->

              <!-- Archives  -->
              <li class="dropdown">
                <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
                <ul class="dropdown-menu">
                  <li>
                    <a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/06/">六月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/05/">五月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/01/">一月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/12/">十二月 2015<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/11/">十一月 2015<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/10/">十月 2015<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/09/">九月 2015<span class="sidebar_archives-count">2</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/04/">四月 2015<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/03/">三月 2015<span class="sidebar_archives-count">2</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/02/">二月 2015<span class="sidebar_archives-count">2</span></a>
                </ul>
                </li>

                <!-- Categories  -->


                <!-- Divider -->
                <li class="divider"></li>


                <!-- Pages  -->

                <li>
                  <a href="/About" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
                </li>

                <li>
                  <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">cloud circle</i>
                
                标签云
            </a>
                </li>

                <li>
                  <a href="/links" title="友情链接">
                
                    <i class="material-icons sidebar-material-icons">link</i>
                
                友情链接
            </a>
                </li>


                <!-- Article Numebr  -->
                <li>
                  <a href="/archives">
            文章总数
            <span class="sidebar-badge">17</span>
        </a>
                </li>
            </ul>

            <!-- Sidebar Divider -->
            <div class="sidebar-divider"></div>

            <!-- Sidebar Footer -->
            <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

            <!-- Theme Material
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>
 -->
            <!-- Help & Support -->
            <!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
    sidebar.help
    <span class="mdl-button__ripple-container">
      <span class="mdl-ripple"></span>
    </span>
  </div>
</a>
-->

            <!-- Feedback -->
            <!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

            <!-- Abount Theme -->
            <!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->
          </div>

          <!-- Sidebar Sponsor -->

        </aside>

      </div>


      <!-- Footer Top Button -->
      <div class="toTop-wrap">
        <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
      </div>


      <!--Footer-->
      <footer class="mdl-mini-footer" id="bottom">

        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
          <!-- Twitter -->


          <!-- Facebook -->


          <!-- Google + -->

          <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
                <span class="visuallyhidden">Google Plus</span>
            </button></a>


          <!-- Weibo -->

          <a href="http://weibo.com/siriuspj" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
                <span class="visuallyhidden">Weibo</span>
            </button></a>


          <!-- Instagram -->


          <!-- Tumblr -->


          <!-- Github -->

          <a href="https://github.com/pangjian" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
                <span class="visuallyhidden">Github</span>
            </button></a>


          <!-- LinkedIn -->

          <a href="https://www.linkedin.com/in/健-庞-44777310b" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-linkedin.png);">
                <span class="visuallyhidden">LinkedIn</span>
            </button></a>


          <!-- Zhihu -->


          <!-- Bilibili -->


          <!-- Telegram -->

        </div>

        <!--Copyright-->
        <div id="copyright">Copyright&nbsp;©&nbsp;
          <script type="text/javascript">
            var fd = new Date();
            document.write(fd.getFullYear());
          </script>&nbsp;Rum's Blog
          <br>Documentation licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><b>CC BY-SA 4.0</b></a>.
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
          <div>
            <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
            <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
          </div>
        </div>

      </footer>

      <!-- Import File -->
      <script src="/js/highlight.min.js" type="text/javascript"></script>
      <script src="/js/js.js" type="text/javascript"></script>
      <script src="/js/nprogress.js" type="text/javascript"></script>

      <script type="text/javascript">
        NProgress.configure({
          showSpinner: true
        });
        NProgress.start();

        $('#nprogress .bar').css({
          'background': '#FF4081'
        });
        $('#nprogress .peg').css({
          'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
        });
        $('#nprogress .spinner-icon').css({
          'border-top-color': '#FF4081',
          'border-left-color': '#FF4081'
        });

        setTimeout(function() {
          NProgress.done();
          $('.fade').removeClass('out');
        }, 800);
      </script>


      <script src="/js/smoothscroll.js" type="text/javascript"></script>




      <!-- Leancloud -->
      <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
      <script>
        AV.initialize("BvJcby3BNlDWQWq9qjji2NEK-gzGzoHsz", "3IcnGJ5Ad8PCCzUe2vLuDIaz");
      </script>
      <script>
        function showTime(Counter) {
          var query = new AV.Query(Counter);
          $('.leancloud-views_num').each(function() {
            var url = $(this).attr('id').trim();
            query.equalTo('url', url);
            query.find({
              success: function(results) {
                if (results.length === 0) {
                  var content = '0 ' + $(document.getElementById(url)).text();
                  $(document.getElementById(url)).text(content);
                  return;
                }
                for (var i = 0; i < results.length; i++) {
                  var object = results[i];
                  var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
                  $(document.getElementById(url)).text(content);
                }
              },
              error: function(object, error) {
                console.log('Error: ' + error.code + ' ' + error.message);
              }
            });
          });
        }

        function addCount(Counter) {
          var Counter = AV.Object.extend('Counter');
          url = $('.leancloud-views_num').attr('id').trim();
          title = $('.leancloud-views_num').attr('data-flag-title').trim();
          var query = new AV.Query(Counter);
          query.equalTo('url', url);
          query.find({
            success: function(results) {
              if (results.length > 0) {
                var counter = results[0];
                counter.fetchWhenSave(true);
                counter.increment('time');
                counter.save(null, {
                  success: function(counter) {
                    var content = counter.get('time') + ' ' + $(document.getElementById(url)).text();
                    $(document.getElementById(url)).text(content);
                  },
                  error: function(counter, error) {
                    console.log('Failed to save Visitor num, with error message: ' + error.message);
                  }
                });
              } else {
                var newcounter = new Counter();
                newcounter.set('title', title);
                newcounter.set('url', url);
                newcounter.set('time', 1);
                newcounter.save(null, {
                  success: function(newcounter) {
                    console.log('newcounter.get(\'time\')=' + newcounter.get('time'));
                    var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
                    $(document.getElementById(url)).text(content);
                  },
                  error: function(newcounter, error) {
                    console.log('Failed to create');
                  }
                });
              }
            },
            error: function(error) {
              console.log('Error:' + error.code + ' ' + error.message);
            }
          });
        }
        $(function() {
          var Counter = AV.Object.extend('Counter');
          if ($('.leancloud-views_num').length === 1) {
            addCount(Counter);
          } else if ($('.post-title-link').length > 1) {
            showTime(Counter);
          }
        });
      </script>





      <!-- 多说公共 js 代码 start -->
      <script type="text/javascript">
        var duoshuoQuery = {
          short_name: 'IO10'
        };
        (function() {
          var ds = document.createElement('script');
          ds.type = 'text/javascript';
          ds.async = true;
          ds.src = '/js/embed.js';
          ds.charset = 'UTF-8';
          (document.getElementsByTagName('head')[0] ||
            document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
      </script>
      <!-- 多说公共 js 代码 end -->

      <!-- Swiftye -->

      <script type="text/javascript">
        (function(w, d, t, u, n, s, e) {
          w['SwiftypeObject'] = n;
          w[n] = w[n] || function() {
            (w[n].q = w[n].q || []).push(arguments);
          };
          s = d.createElement(t);
          e = d.getElementsByTagName(t)[0];
          s.async = 1;
          s.src = u;
          e.parentNode.insertBefore(s, e);
        })(window, document, 'script', '//s.swiftypecdn.com/install/v2/st.js', '_st');

        _st('install', '-dFQ3V3gswysE7f5VTM_', '2.0.0');
      </script>


      <!-- Local Search-->


      <!-- Window Load-->
      <script>
        $(window).load(function() {
          // Post_Toc parent position fixed
          $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
        });
      </script>

      <!-- MathJax Load-->
    </main>
  </div>
</body>

</html>