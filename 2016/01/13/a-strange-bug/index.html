<!DOCTYPE html>
<html>

<head>
  <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.2.6 -->

  <!-- Title -->

  <title>

    我遇到一个Bug，金额大于一千万就报错 | IO10|PangJian&#39;s Blog
  </title>

  <!-- Favicons -->
  <link rel="icon shortcut" type="image/ico" href="favicon.png">
  <link rel="icon" sizes="192x192" href="/img/favicon.png">
  <link rel="apple-touch-icon" href="favicon.png">

  <!-- Meta & Info -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#0097A7">
  <meta name="author" content="Pang Jian">
  <meta name="description" content="简约 是复杂的最终形式">
  <meta name="keywords" content="null">

  <!--iOS -->
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-title" content="Title">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="480">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="IO10|PangJian&#39;s Blog">

  <!-- The Open Graph protocol -->
  <meta property="og:url" content="http://www.pangjian.me">
  <meta property="og:type" content="blog">
  <meta property="og:title" content="我遇到一个Bug，金额大于一千万就报错 | IO10|PangJian&#39;s Blog">
  <meta property="og:description" content="简约 是复杂的最终形式">

  <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

  <!-- Import CSS -->
  <link rel="stylesheet" href="/css/material.min.css" type="text/css">
  <link rel="stylesheet" href="/css/style.min.css" type="text/css">
  <!-- Config CSS -->


  <!-- Other Styles -->
  <style>
    body,
    html {
      font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    }

    a {
      color: #00838F;
    }

    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge {
      background-color: #0097A7 !important;
    }

    /* Sidebar User Drop Down Menu Text Color */

    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
      color: #0097A7 !important;
    }

    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover>a,
    .sidebar-colored .sidebar-nav li:hover>a i,
    .sidebar-colored .sidebar-nav li>a:hover,
    .sidebar-colored .sidebar-nav li>a:hover i,
    .sidebar-colored .sidebar-nav li>a:focus i,
    .sidebar-colored .sidebar-nav>.open>a,
    .sidebar-colored .sidebar-nav>.open>a:hover,
    .sidebar-colored .sidebar-nav>.open>a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
      color: #0097A7 !important;
    }

    .toTop {
      background: #757575 !important;
    }

    .material-layout .material-post>.material-nav,
    .material-layout .material-index>.material-nav,
    .material-nav a {
      color: #757575;
    }

    #scheme-Paradox .MD-burger-layer {
      background-color: #757575;
    }

    #scheme-Paradox #post-toc-trigger-btn {
      color: #757575;
    }

    .post-toc a:hover {
      color: #00838F;
      text-decoration: underline;
    }

    @media screen and (max-width:480px) {
      .post_thumbnail-custom {
        min-height: 200px;
      }
    }

    @media screen and (min-width: 481px) {
      .post_thumbnail-custom {
        min-height: 350px;
      }
    }
  </style>


  <!-- Theme Background Related-->

  <style>
    body {
      background-image: url(/img/bg.png);
    }
  </style>




  <!-- Fade Effect -->

  <style>
    .fade {
      transition: all 800ms linear;
      -webkit-transform: translate3d(0, 0, 0);
      -moz-transform: translate3d(0, 0, 0);
      -ms-transform: translate3d(0, 0, 0);
      -o-transform: translate3d(0, 0, 0);
      transform: translate3d(0, 0, 0);
      opacity: 1;
    }

    .fade.out {
      opacity: 0;
    }
  </style>
  <script src="/js/jquery.min.js" type="text/javascript"></script>

  <link rel="stylesheet" href="/css/highlight/atom-one-dark.css" type="text/css">

  <!-- UC Browser Compatible-->
  <script>
    var agent = navigator.userAgent.toLowerCase();
    if (agent.indexOf('ucbrowser') > 0) {
      document.write('<link rel="stylesheet" href="/css/uc.css" type="text/css">');
      alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
    }
  </script>

  <!-- Custom Head -->

</head>


<body id="scheme-Paradox">
  <div class="material-layout  mdl-js-layout has-drawer is-upgraded">


    <!-- Main Container -->
    <main class="material-layout__content" id="main">
      <div id="pjax">

        <!-- Top Anchor -->
        <div id="top"></div>


        <!-- Hamburger Button -->
        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>


        <!-- Post TOC -->

        <!-- Back Button -->
        <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

        <!-- Left aligned menu below button -->
        <button id="post-toc-trigger-btn" class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

        <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">


          <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
        </ul>


        <!-- Layouts -->

        <!-- Post Module -->
        <div class="material-post_container">

          <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

              <!-- Post Header(Thumbnail & Title) -->
              <!-- Paradox Post Header -->

              <!-- Custom Thumbnail -->
              <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(/resources/a-strange-bug/BUG.png)">

                <p class="article-headline-p">
                  我遇到一个Bug，金额大于一千万就报错
                </p>
              </div>


              <!-- Paradox Post Info -->
              <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

                <!-- Author Avatar -->
                <div id="author-avatar">
                  <img src="/img/myavatar.jpg" width="44px" height="44px" alt="Author Avatar" />
                </div>
                <!-- Author Name & Date -->
                <div>
                  <strong>Pang Jian</strong>
                  <span>1月 13, 2016</span>
                </div>

                <div class="section-spacer"></div>
                <div>
                  <span class="post-count">总字数：1,117</span>
                  <span class="post-count">预计阅读：4 min</span>
                </div>

                <!-- Favorite -->
                <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

                <!-- Qrcode -->

                <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
            <i class="material-icons" role="presentation">devices other</i>
            <span class="visuallyhidden">devices other</span>
        </button>
                <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
                  <li class="mdl-menu__item">在其它设备中阅读本文章</li>
                  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACZElEQVR42u3aS3bEIAwEwLn/pZMT2G5JwHxeeZWFx1AsQGn0+vvp54WHh4eHh4eHh/dhvFf8XH4ueD/5cvVXl2Ph4eHhHeE9bLUX71xN8R45H/f+HTw8PLyTvGTLvno/Adz/Nh/rYRQ8PDy8r+L1SuHqWHh4eHjfyMsDiHt29ZDAw8PD+zRe8g9/tYC+DzKSsONo1oKHh4cX83aUv6v+Pnq/h4eHhxfwyi1NxdI5aTjY2HSFh4eHt4E3DxqSiCEpr/MvPCwcHh4e3mZe70O99qlqsZ4cOVFJjYeHh7eUV92y59t9dbrVBcXDw8M7ycuHud/EJ20HC1oW8PDw8I7zetFDr/lgUkw3DwY8PDy8Ma83QH65VW1KWLAQeHh4eAd5+bXWvL0gfz/5Gw8PD+88rzqtQqjaCnknhTUeHh7eGV4vTs0XJW9EyEvnZmcEHh4e3jZeEjT0AL3rrkLojIeHh3eclx8Sedk9L9CbTVd4eHh423jzQjYvzautV/mRgIeHh3eGl1/hV1usyhdXrWAXDw8P7128PKJNplI9PNaW4Hh4eHjv5U0mOj9alpXUeHh4eJt5+XV+tV2gGhYny10+GPDw8PCW8noXY3mIkE+3cAzg4eHhHedVn157QR7I5gFEoekKDw8PbynvFT+9CGMy3eby4eHh4R3h5aFqsunPA4vFBwMeHh7eNl41YF1bZOcH1cOBhIeHh/eRvCSeWHWthYeHh/d7vDykqB4wveYtPDw8vJO8ZNJJUJssU/ULSRsBHh4e3kneJAKYtG3lRXMh8MXDw8PbzPu9Bw8PDw8PDw8P7wOefy0m7Tljek9vAAAAAElFTkSuQmCC">
                </ul>


                <!-- Tags (bookmark) -->

                <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
                <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
                  <li class="mdl-menu__item">
                    <a class="post_tag-link" href="/tags/jackson/">jackson</a></li>
                  <li class="mdl-menu__item"><a class="post_tag-link" href="/tags/java/">java</a>
                </ul>


                <!-- Share -->
                <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
                <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">

                  <!-- Leancloud Views -->
                  <a class="post_share-link" href="#">
                    <li class="mdl-menu__item">
                      <span id="/2016/01/13/a-strange-bug/" class="leancloud-views_num" data-flag-title="我遇到一个Bug，金额大于一千万就报错">
     &nbsp;浏览量
</span>
                    </li>
                  </a>




                  <!-- Share Weibo -->

                  <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=我遇到一个Bug，金额大于一千万就报错&url=http://www.pangjian.me//2016/01/13/a-strange-bug/index.html&pic=&searchPic=false&style=simple" target="_blank">
                    <li class="mdl-menu__item">
                      分享到微博
                    </li>
                  </a>


                  <!-- Share Twitter -->

                  <a class="post_share-link" href="https://twitter.com/intent/tweet?text=我遇到一个Bug，金额大于一千万就报错&url=http://www.pangjian.me//2016/01/13/a-strange-bug/index.html&via=Pang Jian" target="_blank">
                    <li class="mdl-menu__item">
                      分享到 Twitter
                    </li>
                  </a>


                  <!-- Share Facebook -->

                  <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://www.pangjian.me//2016/01/13/a-strange-bug/index.html" target="_blank">
                    <li class="mdl-menu__item">
                      分享到 Facebook
                    </li>
                  </a>


                  <!-- Share Google+ -->

                  <a class="post_share-link" href="https://plus.google.com/share?url=http://www.pangjian.me//2016/01/13/a-strange-bug/index.html" target="_blank">
                    <li class="mdl-menu__item">
                      分享到 Google+
                    </li>
                  </a>


                  <!-- Share LinkedIn -->

                  <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=http://www.pangjian.me//2016/01/13/a-strange-bug/index.html&title=我遇到一个Bug，金额大于一千万就报错" target="_blank">
                    <li class="mdl-menu__item">
                      分享到 LinkedIn
                    </li>
                  </a>


                  <!-- Share QQ -->

                  <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=IO10|PangJian&#39;s Blog&title=我遇到一个Bug，金额大于一千万就报错&summary=简约 是复杂的最终形式&pics=http://www.pangjian.mefavicon.png&url=http://www.pangjian.me/2016/01/13/a-strange-bug/index.html"
                    target="_blank">
                    <li class="mdl-menu__item">
                      分享到 QQ
                    </li>
                  </a>


                  <!-- Share Telegram -->

                </ul>
              </div>


              <!-- Post Content -->
              <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">

                <p>这是一个在测试环境发现的一个BUG，感觉很有趣，便写出来分享一下。本文的灵感以及标题都来自于《我遇到一个BUG，每逢周三就崩溃》。<br>我在银行做系统开发，“金额”基本上是最常见的字段，也是最不能出错的字段了。每一个错误都代表着实打实的资金损失，无论是客户的还是银行的。所以，作为开发人员，对这个字段也相对敏感一些。金额这个字段的规则也相对其他字段更复杂一些。举个例子来说，金额是一个数字，可以是这样12；当然也有小数点的情况，比如这样12.34；人们还有这样的习惯，每隔3位有一个逗号分隔符，比如这样1,000.23。可是一千万是个什么特殊情况，为什么会有问题呢？<br>
                  <a id="more"></a><br>目前系统为了校验前端上送的数据，有一套统一的校验机制。大概过程就是，先使用jackson框架将前端上送的JSON数据进行解析，然后根据这个字段配置的正则表达式进行校验，校验不通过，就会报错。<br>这是一个工作日，在我们内部通讯工具上弹出来一个同事的窗口。“我们有一个交易上送金额，80099690.89元，校验就报错，但是8009969.89元校验就不报错。”我见到这个问题后，第一反应是：“怎么可能，这个校验规则在生产环境运行了那么久都没有出错，怎么会突然有问题呢？会不会是哪里搞错了？”然后，这位同事又发来“前端上送的JSON报文中，金额使用的数字类型<code>amount:80099690.89</code>,但我们平时都上送的字符串类型<code>amount:&#39;80,099,690.89&#39;</code>”。于是，我开始怀疑那个正则表达式是否正确，还在埋怨是谁写的正则，居然要求必须有逗号分隔符的时候，我看到了这正则：<code>^(\d*|\d{1,3}(,\d{3})*)(\.\d{1,2})?</code>。居然是对的！完美的考虑了带逗号和不带逗号的场景。这时候，这位同事又发来消息“把金额按string上送就不报错了<code>amount:&#39;80099690.89&#39;</code>”<br>WTF？！下面这个表情就是我当时的表情。<br>
                  <img src="/resources/a-strange-bug/WTF.jpg" alt="WTF"><br>我们知道，在JavaScript中，<code>string</code>和<code>number</code>是可以随时互转的，难道<code>amount:80099690.89</code>和<code>amount:&#39;80099690.89&#39;</code>上送到后端会有不同的逻辑？几千万大小的数字也没有超过精度呀。<br>于是我开始看这篇文章开头提到的那个字段校验公共机制，先使用Jackson解析，然后再利用正则表达式校验。难道是Jackson有问题？看过官方文档，Jackson会将<code>number</code>默认解析成Java的<code>Double</code>型，<code>string</code>则转换为Java的<code>String</code>型，而<code>Double</code>在进行正则校验之前需要先转换为<code>String</code>。<br>
                  <figure class="highlight java">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">Double amount1 = <span class="keyword">new</span> Double(<span class="string">"80099690.89"</span>);</span><br><span class="line">Double amount2 = <span class="keyword">new</span> Double(<span class="string">"8009969.89"</span>);</span><br><span class="line">System.out.print(<span class="string">"amount1 = "</span> + amount1.toString());</span><br><span class="line">System.out.print(<span class="string">"amount2 = "</span> + amount2.toString());</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>打印结果为：<br>
                  <figure class="highlight plain">
                    <table>
                      <tr>
                        <td class="code">
                          <pre><span class="line">amount1 = 8.009969089E7&#10;amount2 = 8009969.89</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                </p>
                <p>相信大家已经看出来了，原来是这样！Java里<code>Double</code>的<code>toString</code>方法当大于7位数的时候会取科学计数法。所以科学计数法的结果是无法匹配这个正则的<code>^(\d*|\d{1,3}(,\d{3})*)(\.\d{1,2})?</code>！<br>从那以后，我终于明白编码规范中为什么要求前端都是用<code>string</code>类型了。我还专门看了接口文档，将类型都调整为了<code>string</code>。<br>其实无论一个bug看上去多么随机和不可思议，如果你挖的足够深的话，总能找到一个符合逻辑的解释，极少有真的“不相关”的错误，几乎都是你自己的错。这就是为什么我微博的简介里会写这么一句话“电脑确实比人靠谱，你和他们打交道时一旦有问题，肯定是你的问题。不像人，即使他们有问题也不轻易承认。”</p>
                <p>写在最后：文中提到的那位同事，现在已经去新的岗位提升自己去了，写这篇文章也算纪念一下我们一起共事的时光。^_^~<br>EOF<br>
                  <span class='source'><blockquote class='source'><p>转载请注明出处：http://www.pangjian.me/2016/01/13/a-strange-bug/</p><p>访问原文「<a href='http://www.pangjian.me/2016/01/13/a-strange-bug/'>我遇到一个Bug，金额大于一千万就报错</a>」获取最佳阅读体验并参与讨论</p></blockquote></span>
                  <script type="text/javascript">
                    (function() {
                      Element.prototype.remove = function() {
                        this.parentElement.removeChild(this);
                      }
                      NodeList.prototype.remove = HTMLCollection.prototype.remove = function() {
                        for (var i = this.length - 1; i >= 0; i--) {
                          if (this[i] && this[i].parentElement) {
                            this[i].parentElement.removeChild(this[i]);
                          }
                        }
                      }
                      var domain = document.domain;
                      var white_list = ['pangjian.info', 'www.pangjian.info', 'pangjian.me', 'www.pangjian.me', 'localhost', '127.0.0.1'];
                      if (white_list.indexOf(domain) >= 0) {
                        var elements = document.getElementsByClassName('source');
                        elements.remove();
                      }
                    })()
                  </script>

                </p>



              </div>



              <!-- Post Comments -->

              <!-- 使用多说评论 -->
              <link rel="stylesheet" href="/css/duoshuo.min.css" type="text/css">
              <style>
                #ds-thread #ds-reset .ds-post-button {
                  background-color: #0097A7 !important;
                }

                #ds-wrapper #ds-reset .ds-icons-32 {
                  background-color: #0097A7 !important;
                }

                #ds-reset .ds-highlight {
                  color: #0097A7 !important;
                }
              </style>
              <div id="comments">
                <!-- 多说评论框 start -->
                <div class="ds-thread" data-thread-key="2016/01/13/a-strange-bug/" data-url="http://www.pangjian.me/2016/01/13/a-strange-bug/" data-title="我遇到一个Bug，金额大于一千万就报错">
                </div>
                <!-- 多说评论框 end -->
              </div>

            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
              <!-- Prev Nav -->

              <a href="/2016/02/07/happy-new-year-2016/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>


              <!-- Section Spacer -->
              <div class="section-spacer"></div>

              <!-- Next Nav -->

              <a href="/2015/12/03/pjax-your-blog/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>

            </nav>
          </div>
        </div>


        <!-- Overlay For Active Sidebar -->
        <div class="sidebar-overlay"></div>

        <!-- Material sidebar -->
        <aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
          <div id="sidebar-main">
            <!-- Sidebar Header -->
            <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
              <!-- Top bar -->
              <div class="top-bar"></div>

              <!-- Sidebar toggle button -->
              <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

              <!-- Sidebar Avatar -->
              <div class="sidebar-image">
                <img src="/img/myavatar.jpg" alt="Pang Jian's avatar">
              </div>

              <!-- Sidebar Email -->
              <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        pangjian1010@gmail.com
        <b class="caret"></b>
    </a>
            </div>

            <!-- Sidebar Navigation  -->
            <ul class="nav sidebar-nav">
              <!-- User dropdown  -->
              <li class="dropdown">
                <ul id="settings-dropdown" class="dropdown-menu">

                  <li>
                    <a href="mailto:pangjian1010@gamil.com" target="_blank" title="Email Me">
                        <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                  </li>

                </ul>
              </li>

              <!-- Homepage -->
              <li id="sidebar-first-li">
                <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
            主页
        </a>
              </li>

              <!-- I'm Feeling Lucky -->
              <!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
    -->

              <!-- Archives  -->
              <li class="dropdown">
                <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
                <ul class="dropdown-menu">
                  <li>
                    <a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/06/">六月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/05/">五月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2016/01/">一月 2016<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/12/">十二月 2015<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/11/">十一月 2015<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/10/">十月 2015<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/09/">九月 2015<span class="sidebar_archives-count">2</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/04/">四月 2015<span class="sidebar_archives-count">1</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/03/">三月 2015<span class="sidebar_archives-count">2</span></a></li>
                  <li><a class="sidebar_archives-link" href="/archives/2015/02/">二月 2015<span class="sidebar_archives-count">2</span></a>
                </ul>
                </li>

                <!-- Categories  -->


                <!-- Divider -->
                <li class="divider"></li>


                <!-- Pages  -->

                <li>
                  <a href="/About" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
                </li>

                <li>
                  <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">cloud circle</i>
                
                标签云
            </a>
                </li>

                <li>
                  <a href="/links" title="友情链接">
                
                    <i class="material-icons sidebar-material-icons">link</i>
                
                友情链接
            </a>
                </li>


                <!-- Article Numebr  -->
                <li>
                  <a href="/archives">
            文章总数
            <span class="sidebar-badge">17</span>
        </a>
                </li>
            </ul>

            <!-- Sidebar Divider -->
            <div class="sidebar-divider"></div>

            <!-- Sidebar Footer -->
            <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

            <!-- Theme Material
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>
 -->
            <!-- Help & Support -->
            <!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
    sidebar.help
    <span class="mdl-button__ripple-container">
      <span class="mdl-ripple"></span>
    </span>
  </div>
</a>
-->

            <!-- Feedback -->
            <!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

            <!-- Abount Theme -->
            <!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->
          </div>

          <!-- Sidebar Sponsor -->

        </aside>

      </div>


      <!-- Footer Top Button -->
      <div class="toTop-wrap">
        <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
      </div>


      <!--Footer-->
      <footer class="mdl-mini-footer" id="bottom">

        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
          <!-- Twitter -->


          <!-- Facebook -->


          <!-- Google + -->

          <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
                <span class="visuallyhidden">Google Plus</span>
            </button></a>


          <!-- Weibo -->

          <a href="http://weibo.com/siriuspj" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
                <span class="visuallyhidden">Weibo</span>
            </button></a>


          <!-- Instagram -->


          <!-- Tumblr -->


          <!-- Github -->

          <a href="https://github.com/pangjian" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
                <span class="visuallyhidden">Github</span>
            </button></a>


          <!-- LinkedIn -->

          <a href="https://www.linkedin.com/in/健-庞-44777310b" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-linkedin.png);">
                <span class="visuallyhidden">LinkedIn</span>
            </button></a>


          <!-- Zhihu -->


          <!-- Bilibili -->


          <!-- Telegram -->

        </div>

        <!--Copyright-->
        <div id="copyright">Copyright&nbsp;©&nbsp;
          <script type="text/javascript">
            var fd = new Date();
            document.write(fd.getFullYear());
          </script>&nbsp;IO10|PangJian's Blog
          <br>Documentation licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><b>CC BY-SA 4.0</b></a>.
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
          <div>
            <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
            <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
          </div>
        </div>

      </footer>

      <!-- Import File -->
      <script src="/js/highlight.min.js" type="text/javascript"></script>
      <script src="/js/js.js" type="text/javascript"></script>
      <script src="/js/nprogress.js" type="text/javascript"></script>

      <script type="text/javascript">
        NProgress.configure({
          showSpinner: true
        });
        NProgress.start();

        $('#nprogress .bar').css({
          'background': '#FF4081'
        });
        $('#nprogress .peg').css({
          'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
        });
        $('#nprogress .spinner-icon').css({
          'border-top-color': '#FF4081',
          'border-left-color': '#FF4081'
        });

        setTimeout(function() {
          NProgress.done();
          $('.fade').removeClass('out');
        }, 800);
      </script>


      <script src="/js/smoothscroll.js" type="text/javascript"></script>




      <!-- Leancloud -->
      <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
      <script>
        AV.initialize("BvJcby3BNlDWQWq9qjji2NEK-gzGzoHsz", "3IcnGJ5Ad8PCCzUe2vLuDIaz");
      </script>
      <script>
        function showTime(Counter) {
          var query = new AV.Query(Counter);
          $('.leancloud-views_num').each(function() {
            var url = $(this).attr('id').trim();
            query.equalTo('url', url);
            query.find({
              success: function(results) {
                if (results.length === 0) {
                  var content = '0 ' + $(document.getElementById(url)).text();
                  $(document.getElementById(url)).text(content);
                  return;
                }
                for (var i = 0; i < results.length; i++) {
                  var object = results[i];
                  var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
                  $(document.getElementById(url)).text(content);
                }
              },
              error: function(object, error) {
                console.log('Error: ' + error.code + ' ' + error.message);
              }
            });
          });
        }

        function addCount(Counter) {
          var Counter = AV.Object.extend('Counter');
          url = $('.leancloud-views_num').attr('id').trim();
          title = $('.leancloud-views_num').attr('data-flag-title').trim();
          var query = new AV.Query(Counter);
          query.equalTo('url', url);
          query.find({
            success: function(results) {
              if (results.length > 0) {
                var counter = results[0];
                counter.fetchWhenSave(true);
                counter.increment('time');
                counter.save(null, {
                  success: function(counter) {
                    var content = counter.get('time') + ' ' + $(document.getElementById(url)).text();
                    $(document.getElementById(url)).text(content);
                  },
                  error: function(counter, error) {
                    console.log('Failed to save Visitor num, with error message: ' + error.message);
                  }
                });
              } else {
                var newcounter = new Counter();
                newcounter.set('title', title);
                newcounter.set('url', url);
                newcounter.set('time', 1);
                newcounter.save(null, {
                  success: function(newcounter) {
                    console.log('newcounter.get(\'time\')=' + newcounter.get('time'));
                    var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
                    $(document.getElementById(url)).text(content);
                  },
                  error: function(newcounter, error) {
                    console.log('Failed to create');
                  }
                });
              }
            },
            error: function(error) {
              console.log('Error:' + error.code + ' ' + error.message);
            }
          });
        }
        $(function() {
          var Counter = AV.Object.extend('Counter');
          if ($('.leancloud-views_num').length === 1) {
            addCount(Counter);
          } else if ($('.post-title-link').length > 1) {
            showTime(Counter);
          }
        });
      </script>





      <!-- 多说公共 js 代码 start -->
      <script type="text/javascript">
        var duoshuoQuery = {
          short_name: 'IO10'
        };
        (function() {
          var ds = document.createElement('script');
          ds.type = 'text/javascript';
          ds.async = true;
          ds.src = '/js/embed.js';
          ds.charset = 'UTF-8';
          (document.getElementsByTagName('head')[0] ||
            document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
      </script>
      <!-- 多说公共 js 代码 end -->

      <!-- Swiftye -->


      <!-- Local Search-->

      <script>
        var searchFunc = function(path, search_id, content_id) {
          'use strict';
          $.ajax({
            url: path,
            dataType: 'xml',
            success: function(xmlResponse) {
              // get the contents from search data
              var datas = $('entry', xmlResponse).map(function() {
                return {
                  title: $('title', this).text(),
                  content: $('content', this).text(),
                  url: $('url', this).text()
                };
              }).get();
              var $input = document.getElementById(search_id);
              var $resultContent = document.getElementById(content_id);
              $input.addEventListener('input', function() {
                var str = '<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length <= 0) {
                  return;
                }
                // perform local searching
                datas.forEach(function(data) {
                  var isMatch = true;
                  var content_index = [];
                  var data_title = data.title.trim().toLowerCase();
                  var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                  var data_url = data.url;
                  var index_title = -1;
                  var index_content = -1;
                  var first_occur = -1;
                  // only match artiles with not empty titles and contents
                  if (data_title != '' && data_content != '') {
                    keywords.forEach(function(keyword, i) {
                      index_title = data_title.indexOf(keyword);
                      index_content = data_content.indexOf(keyword);
                      if (index_title < 0 && index_content < 0) {
                        isMatch = false;
                      } else {
                        if (index_content < 0) {
                          index_content = 0;
                        }
                        if (i === 0) {
                          first_occur = index_content;
                        }
                      }
                    });
                  }
                  // show search results
                  if (isMatch) {
                    str += '<li><a href="' + data_url + '" class="search-result-title" target="_blank">' + data_title;
                    var content = data.content.trim().replace(/<[^>]+>/g, '');
                    if (first_occur >= 0) {
                      // cut out characters
                      var start = first_occur - 6;
                      var end = first_occur + 6;
                      if (start < 0) {
                        start = 0;
                      }
                      if (start === 0) {
                        end = 10;
                      }
                      if (end > content.length) {
                        end = content.length;
                      }
                      var match_content = content.substr(start, end);
                      // highlight all keywords
                      keywords.forEach(function(keyword) {
                        var regS = new RegExp(keyword, 'gi');
                        match_content = match_content.replace(regS, '<em class="search-keyword">' + keyword + '</em>');
                      })
                      str += '<p class="search-result">' + match_content + '...</p>' + '</a>';
                    }
                  }
                });
                $resultContent.innerHTML = str;
              });
            }
          });
        }
      </script>

      <script>
        var inputArea = document.querySelector('#search');
        var getSearchFile = function() {
          var path = 'search.xml';
          searchFunc(path, 'search', 'local-search-result');
        }

        if (inputArea) {
          inputArea.onfocus = function() {
            getSearchFile();
          }
        }
      </script>


      <!-- Window Load-->
      <script>
        $(window).load(function() {
          // Post_Toc parent position fixed
          $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
        });
      </script>

      <!-- MathJax Load-->
    </main>
  </div>
</body>

</html>